{% extends 'basenav.html'  %}
{%load static%}
{% block titulo %}

{% endblock %}
{% block contenido %}
	<section class="conteniAGREli">
 		{% csrf_token %}
	    <div>
		<table class="table table-striped col-sm col-md col-lg">
			<h3 class="text-center">LISTA PERSONAS</h3>
		       	
        </div>
		<thead>
			<tr>
				<th scope="col">id</th>
				<th scope="col">nombre</th>
				<th scope="col">apellido</th>
				<th scope="col">identificacion</th>
				<!--<th scope="col">email</th>-->
				<th scope="col">telefono</th>
				<th scope="col">direccion</th>
				<th scope="col">pregunta de seguridad</th>
				<th scope="col">respuesta</th>
			</tr>
		</thead>
		<tbody>
			{% for p in lista%}
				<tr>
					<td >{{p.id}}</td>
					<td>{{p.nombre}}</td>
					<td>{{p.apellido}}</td>
					<td>{{p.identificacion}}</td>
					<!--<td>{{p.email}}</td>-->
					<td>{{p.telefono}}</td>
					<td>{{p.direccion}}</td>
					<td>{{p.preguntasegu}}</td>
					<td>{{p.respuesta}}</td>
					<td> 
						<!--<a class="btn btn-primary " id="btn-mostrar" href="{% url 'vista_eliminar_persona' id_Persona=p.id%}" disabled> eliminar registro</a> -->
				
						<button class="btn btn-primary btn-mostrar" onclick="borrar_usu({{p.id}},{{p.identificacion}})"> eliminar registro</button> 
					</td>
				</tr>


			{% endfor%}
		</tbody>

	    </table>
	    </div>
	 </section>   


	   {% block javascript%}
	   
	   <!--<script src="{% static "js/s.js" %}"></script>
	    <script src="{% static "js/mod.js" %}"></script>-->
	  <script src="{% static "js/sweetalert2@9.js" %}"></script>
	  <script type="text/javascript">
	  function nose(id, nombres){
	  	console.log('nose');
	  	/*var urlba='eliminar_persona';*/
	  	var u='https://carsafelowydavo.herokuapp.com/eliminar_persona/'
	  	var id_Persona=id;
	  	/*window.href = urlba+'/'+id_Persona;*/
	  	$.ajax({
		url: u+id_Persona,
		success: function(respuesta) {
			console.log('respuesta ok');

			 Swal.fire(
			      'Deleted!',
			      'El registro '+nombres +' ha sido eliminado.',
			      'success'
			     
			).then((confirm)=>{
				if(confirm.value==true)
				window.location.reload();

			});

			
			
		},
		error: function() {
	        console.log("No se ha podido obtener la informaciÃ³n");
	    }
	    
		});

	  }	
	  function borrar_usu(id, nombres) 
	  	{ 
	  		console.log('consola'+id);
	  		Swal.fire({
			  title: 'Estas seguro?',
			  text: "Quieres eliminar el registro identificado: "+nombres,
			  icon: 'warning',
			  backdrop: 'rgba(0,10,123,0.4)',
			  showCancelButton: true,
			  confirmButtonColor: '#3085d6',
			  cancelButtonColor: '#d33',
			  confirmButtonText: 'Aceptar'
				}).then((result) => {
			  if (result.value) {
			   nose(id, nombres);
			   
			  }
			  else{

			  }
			});
	  	}


	  </script>
      {% endblock %}
{% endblock %}
